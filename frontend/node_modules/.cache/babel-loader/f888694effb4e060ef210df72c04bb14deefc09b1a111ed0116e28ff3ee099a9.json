{"ast":null,"code":"import _slicedToArray from \"/home/daniel/go/src/github.com/DanielYevelkin/clutch-custom-gateway/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/home/daniel/go/src/github.com/DanielYevelkin/clutch-custom-gateway/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _toConsumableArray from \"/home/daniel/go/src/github.com/DanielYevelkin/clutch-custom-gateway/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _ from \"lodash\";\nimport { ManagerAction, useManagerState } from \"./state\";\nvar _assign = function assign(key, value) {\n  return function (dispatch) {\n    dispatch({\n      type: ManagerAction.SET,\n      payload: {\n        key: key,\n        value: value\n      }\n    });\n  };\n};\nvar _reset = function reset() {\n  return function (dispatch) {\n    dispatch({\n      type: ManagerAction.RESET\n    });\n  };\n};\nvar _update = function update(key, value) {\n  return function (dispatch) {\n    dispatch({\n      type: ManagerAction.UPDATE,\n      payload: {\n        key: key,\n        value: value\n      }\n    });\n  };\n};\nvar _hydrate = function hydrate(key) {\n  return function (dispatch, getState) {\n    var state = getState();\n    if (Object.keys(state[key]).includes(\"hydrator\")) {\n      var _state$key;\n      dispatch({\n        type: ManagerAction.HYDRATE_START,\n        payload: {\n          key: key\n        }\n      });\n      var args = state[key].deps.map(function (dep) {\n        return state[dep].data;\n      });\n      if (args.some(function (element) {\n        return _.isEmpty(element);\n      })) {\n        dispatch({\n          type: ManagerAction.HYDRATE_END,\n          payload: {\n            key: key,\n            error: {\n              message: \"Missing dependency for data layout: '\".concat(key, \"'\"),\n              status: {\n                code: 404,\n                text: \"Not Found\"\n              }\n            }\n          }\n        });\n        return;\n      }\n      return (_state$key = state[key]).hydrator.apply(_state$key, _toConsumableArray(args)).then(function (result) {\n        dispatch({\n          type: ManagerAction.HYDRATE_END,\n          payload: {\n            key: key,\n            result: state[key].transformResponse(result)\n          }\n        });\n      }).catch(function (error) {\n        dispatch({\n          type: ManagerAction.HYDRATE_END,\n          payload: {\n            key: key,\n            error: state[key].transformError(error)\n          }\n        });\n      });\n    }\n  };\n};\nvar defaultTransform = function defaultTransform(data) {\n  return data;\n};\nvar defaultErrorTransform = function defaultErrorTransform(err) {\n  return err;\n};\nvar initialLayoutStepState = function initialLayoutStepState() {\n  return {\n    data: {},\n    isLoading: true,\n    error: null\n  };\n};\nvar defaultState = function defaultState(layouts) {\n  var initializedLayouts = {};\n  Object.keys(layouts).forEach(function (key) {\n    var _a;\n    var layout = layouts[key];\n    initializedLayouts[key] = initialLayoutStepState();\n    if ((layout === null || layout === void 0 ? void 0 : layout.hydrator) !== undefined) {\n      initializedLayouts[key] = _objectSpread(_objectSpread({}, initializedLayouts[key]), {}, {\n        hydrator: (layout === null || layout === void 0 ? void 0 : layout.hydrator) || function () {},\n        transformResponse: layout.transformResponse || defaultTransform,\n        transformError: layout.transformError || defaultErrorTransform,\n        deps: (layout === null || layout === void 0 ? void 0 : layout.deps) || [],\n        cache: (_a = layout.cache) !== null && _a !== void 0 ? _a : false\n      });\n    }\n  });\n  return initializedLayouts;\n};\nvar useDataLayoutManager = function useDataLayoutManager(layouts) {\n  var initialState = defaultState(layouts);\n  var _useManagerState = useManagerState(initialState),\n    _useManagerState2 = _slicedToArray(_useManagerState, 2),\n    state = _useManagerState2[0],\n    dispatch = _useManagerState2[1];\n  return {\n    state: state,\n    assign: function assign(key, value) {\n      return dispatch(_assign(key, value));\n    },\n    hydrate: function hydrate(key) {\n      return dispatch(_hydrate(key));\n    },\n    update: function update(key, value) {\n      return dispatch(_update(key, value));\n    },\n    reset: function reset() {\n      return dispatch(_reset());\n    }\n  };\n};\nexport default useDataLayoutManager;","map":{"version":3,"names":["_","ManagerAction","useManagerState","assign","key","value","dispatch","type","SET","payload","reset","RESET","update","UPDATE","hydrate","getState","state","Object","keys","includes","_state$key","HYDRATE_START","args","deps","map","dep","data","some","element","isEmpty","HYDRATE_END","error","message","concat","status","code","text","hydrator","apply","_toConsumableArray","then","result","transformResponse","catch","transformError","defaultTransform","defaultErrorTransform","err","initialLayoutStepState","isLoading","defaultState","layouts","initializedLayouts","forEach","_a","layout","undefined","_objectSpread","cache","useDataLayoutManager","initialState","_useManagerState","_useManagerState2","_slicedToArray"],"sources":["/home/daniel/go/src/github.com/DanielYevelkin/clutch-custom-gateway/frontend/node_modules/@clutch-sh/data-layout/dist/manager.js"],"sourcesContent":["import _ from \"lodash\";\nimport { ManagerAction, useManagerState } from \"./state\";\nconst assign = (key, value) => {\n    return dispatch => {\n        dispatch({\n            type: ManagerAction.SET,\n            payload: { key, value },\n        });\n    };\n};\nconst reset = () => {\n    return dispatch => {\n        dispatch({\n            type: ManagerAction.RESET,\n        });\n    };\n};\nconst update = (key, value) => {\n    return dispatch => {\n        dispatch({\n            type: ManagerAction.UPDATE,\n            payload: { key, value },\n        });\n    };\n};\nconst hydrate = (key) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        if (Object.keys(state[key]).includes(\"hydrator\")) {\n            dispatch({\n                type: ManagerAction.HYDRATE_START,\n                payload: { key },\n            });\n            const args = state[key].deps.map(dep => state[dep].data);\n            if (args.some(element => _.isEmpty(element))) {\n                dispatch({\n                    type: ManagerAction.HYDRATE_END,\n                    payload: {\n                        key,\n                        error: {\n                            message: `Missing dependency for data layout: '${key}'`,\n                            status: {\n                                code: 404,\n                                text: \"Not Found\",\n                            },\n                        },\n                    },\n                });\n                return;\n            }\n            return state[key]\n                .hydrator(...args)\n                .then(result => {\n                dispatch({\n                    type: ManagerAction.HYDRATE_END,\n                    payload: {\n                        key,\n                        result: state[key].transformResponse(result),\n                    },\n                });\n            })\n                .catch(error => {\n                dispatch({\n                    type: ManagerAction.HYDRATE_END,\n                    payload: {\n                        key,\n                        error: state[key].transformError(error),\n                    },\n                });\n            });\n        }\n    };\n};\nconst defaultTransform = (data) => data;\nconst defaultErrorTransform = (err) => err;\nconst initialLayoutStepState = () => ({ data: {}, isLoading: true, error: null });\nconst defaultState = (layouts) => {\n    const initializedLayouts = {};\n    Object.keys(layouts).forEach(key => {\n        var _a;\n        const layout = layouts[key];\n        initializedLayouts[key] = initialLayoutStepState();\n        if ((layout === null || layout === void 0 ? void 0 : layout.hydrator) !== undefined) {\n            initializedLayouts[key] = {\n                ...initializedLayouts[key],\n                hydrator: (layout === null || layout === void 0 ? void 0 : layout.hydrator) || (() => { }),\n                transformResponse: layout.transformResponse || defaultTransform,\n                transformError: layout.transformError || defaultErrorTransform,\n                deps: (layout === null || layout === void 0 ? void 0 : layout.deps) || [],\n                cache: (_a = layout.cache) !== null && _a !== void 0 ? _a : false,\n            };\n        }\n    });\n    return initializedLayouts;\n};\nconst useDataLayoutManager = (layouts) => {\n    const initialState = defaultState(layouts);\n    const [state, dispatch] = useManagerState(initialState);\n    return {\n        state,\n        assign: (key, value) => dispatch(assign(key, value)),\n        hydrate: key => dispatch(hydrate(key)),\n        update: (key, value) => dispatch(update(key, value)),\n        reset: () => dispatch(reset()),\n    };\n};\nexport default useDataLayoutManager;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}